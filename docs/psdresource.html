<!DOCTYPE html>  <html> <head>   <title>psdresource.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="log.html">                 log.coffee               </a>                                           <a class="source" href="psd.html">                 psd.coffee               </a>                                           <a class="source" href="psdfile.html">                 psdfile.coffee               </a>                                           <a class="source" href="psdheader.html">                 psdheader.coffee               </a>                                           <a class="source" href="psdimage.html">                 psdimage.coffee               </a>                                           <a class="source" href="psdlayer.html">                 psdlayer.coffee               </a>                                           <a class="source" href="psdlayereffect.html">                 psdlayereffect.coffee               </a>                                           <a class="source" href="psdlayermask.html">                 psdlayermask.coffee               </a>                                           <a class="source" href="psdresource.html">                 psdresource.coffee               </a>                                           <a class="source" href="psdtypetool.html">                 psdtypetool.coffee               </a>                                           <a class="source" href="util.html">                 util.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               psdresource.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">PSDResource</span>
  <span class="nv">RESOURCE_DESCRIPTIONS =</span>
    <span class="mi">1000</span><span class="o">:</span> 
      <span class="nv">name: </span><span class="s1">&#39;PS2.0 mode data&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> 
        <span class="p">[</span>
          <span class="nx">@channels</span><span class="p">,</span>
          <span class="nx">@rows</span><span class="p">,</span>
          <span class="nx">@cols</span><span class="p">,</span>
          <span class="nx">@depth</span><span class="p">,</span>
          <span class="nx">@mode</span>
        <span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;5H&quot;</span>

    <span class="mi">1001</span><span class="o">:</span> </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Data format missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Macintosh print record&#39;</span>

    <span class="mi">1003</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Obsolete</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;PS2.0 indexed color table&#39;</span>

    <span class="mi">1005</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;ResolutionInfo&#39;</span>

    <span class="mi">1006</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Names of the alpha channels&#39;</span>

    <span class="mi">1007</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;DisplayInfo&#39;</span>

    <span class="mi">1008</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Caption&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="vi">@caption = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">readLengthWithString</span><span class="p">()</span>

    <span class="mi">1009</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Border information&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span>
        <span class="p">[</span><span class="nx">@width</span><span class="p">,</span> <span class="nx">units</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;fH&quot;</span>

        <span class="vi">@units = </span><span class="k">switch</span> <span class="nx">units</span>
          <span class="k">when</span> <span class="mi">1</span> <span class="k">then</span> <span class="s2">&quot;inches&quot;</span>
          <span class="k">when</span> <span class="mi">2</span> <span class="k">then</span> <span class="s2">&quot;cm&quot;</span>
          <span class="k">when</span> <span class="mi">3</span> <span class="k">then</span> <span class="s2">&quot;points&quot;</span>
          <span class="k">when</span> <span class="mi">4</span> <span class="k">then</span> <span class="s2">&quot;picas&quot;</span>
          <span class="k">when</span> <span class="mi">5</span> <span class="k">then</span> <span class="s2">&quot;columns&quot;</span>

    <span class="mi">1010</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Background color&#39;</span>

    <span class="mi">1011</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Print flags&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> 
        <span class="nv">start = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">tell</span><span class="p">()</span>
        <span class="p">[</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>These are all simple boolean flags</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">@labels</span><span class="p">,</span>
          <span class="nx">@cropMarks</span><span class="p">,</span>
          <span class="nx">@colorBars</span><span class="p">,</span>
          <span class="nx">@registrationMarks</span><span class="p">,</span>
          <span class="nx">@negative</span><span class="p">,</span>
          <span class="nx">@flip</span><span class="p">,</span>
          <span class="nx">@interpolate</span><span class="p">,</span>
          <span class="nx">@caption</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Apparently this isn't a 1 byte boolean?
@printFlags</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;9B&quot;</span>

        <span class="nx">@file</span><span class="p">.</span><span class="nx">seek</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">@size</span><span class="p">,</span> <span class="kc">false</span>

    <span class="mi">1012</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Grayscale/multichannel halftoning info&#39;</span>

    <span class="mi">1013</span><span class="o">:</span> </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Color halftoning info&#39;</span>

    <span class="mi">1014</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Duotone halftoning info&#39;</span>

    <span class="mi">1015</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Grayscale/multichannel transfer function&#39;</span>

    <span class="mi">1016</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Color transfer functions&#39;</span>

    <span class="mi">1017</span><span class="o">:</span> </pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Duotone transfer functions&#39;</span>

    <span class="mi">1018</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Duotone image info&#39;</span>

    <span class="mi">1019</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Not sure if 1 or 2 values. Spec unclear.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;B&amp;W values for the dot range&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@bwvalues</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;H&quot;</span>

    <span class="mi">1021</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;EPS options&#39;</span>

    <span class="mi">1022</span><span class="o">:</span> 
      <span class="nv">name: </span><span class="s1">&#39;Quick Mask info&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> 
        <span class="p">[</span>
          <span class="nx">@quickMaskChannelID</span><span class="p">,</span> 
          <span class="nx">@wasMaskEmpty</span>
        <span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;HB&quot;</span>

    <span class="mi">1024</span><span class="o">:</span> </pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>target = 0 means bottom layer</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Layer state info&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@targetLayer</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;H&quot;</span>

    <span class="mi">1025</span><span class="o">:</span> </pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>TODO (not saved though, so optional?)</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Working path&#39;</span>

    <span class="mi">1026</span><span class="o">:</span> 
      <span class="nv">name: </span><span class="s1">&#39;Layers group info&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span>
        <span class="nv">start = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">tell</span><span class="p">()</span>
        <span class="vi">@layerGroupInfo = </span><span class="p">[]</span>
        <span class="k">while</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">@size</span>
          <span class="p">[</span><span class="nx">info</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;H&quot;</span>
          <span class="nx">@layerGroupInfo</span><span class="p">.</span><span class="nx">push</span> <span class="nx">info</span>

    <span class="mi">1028</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;IPTC-NAA record (File Info)&#39;</span>

    <span class="mi">1029</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Missing from spec</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Image mode for raw format files&#39;</span>

    <span class="mi">1030</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Private. Can't be parsed?</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;JPEG quality&#39;</span>

    <span class="mi">1032</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Grid and guides info&#39;</span>

    <span class="mi">1033</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Thumbnail resource&#39;</span>

    <span class="mi">1034</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Copyright flag&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@copyrighted</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;#{@size}B&quot;</span>

    <span class="mi">1035</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;URL&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@url</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;#{@size}s&quot;</span>

    <span class="mi">1036</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>TODO. Supersedes 1033.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Thumbnail resource&#39;</span>

    <span class="mi">1037</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Obsolete</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Global Angle&#39;</span>

    <span class="mi">1038</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Obsolete</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Color samplers resource&#39;</span>

    <span class="mi">1039</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;ICC Profile&#39;</span>

    <span class="mi">1040</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Watermark&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@watermarked</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;B&quot;</span>

    <span class="mi">1041</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;ICC Untagged&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@disableProfile</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;B&quot;</span>

    <span class="mi">1042</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Effects visible&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@showEffects</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;B&quot;</span>

    <span class="mi">1043</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Spot Halftone&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span>
        <span class="p">[</span><span class="nx">@halftoneVersion</span><span class="p">,</span> <span class="nx">length</span><span class="p">]</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;LL&quot;</span>
        <span class="vi">@halftoneData = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">read</span> <span class="nx">length</span>

    <span class="mi">1044</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Document specific IDs seed number&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@docIdSeedNumber</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;L&quot;</span>

    <span class="mi">1045</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Spec is a bit unclear. TODO.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Unicode Alpha Names&#39;</span>

    <span class="mi">1046</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Indexed Color Table Count&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@indexedColorCount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;H&quot;</span>

    <span class="mi">1047</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Transparent Index&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@transparencyIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;H&quot;</span>

    <span class="mi">1049</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Global Altitude&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="p">[</span><span class="nx">@globalAltitude</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;L&quot;</span>

    <span class="mi">1050</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Slices&#39;</span>

    <span class="mi">1051</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Workflow URL&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> <span class="vi">@workflowName = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">readLengthWithString</span><span class="p">()</span>

    <span class="mi">1052</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Jump To XPEP&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span> 
        <span class="p">[</span>
          <span class="nx">@majorVersion</span><span class="p">,</span>
          <span class="nx">@minorVersion</span><span class="p">,</span>
          <span class="nx">count</span>
        <span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;HHL&quot;</span>

        <span class="vi">@xpepBlocks = </span><span class="p">[]</span>
        <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">count</span><span class="p">]</span>
          <span class="nv">block =</span>
            <span class="nv">size: </span><span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;L&quot;</span>
            <span class="nv">key: </span><span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;4s&quot;</span>

          <span class="k">if</span> <span class="nx">block</span><span class="p">.</span><span class="nx">key</span> <span class="o">is</span> <span class="s2">&quot;jtDd&quot;</span>
            <span class="nv">block.dirty = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">readBoolean</span><span class="p">()</span>
          <span class="k">else</span>
            <span class="nv">block.modDate = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;L&quot;</span>

          <span class="nx">@xpepBlocks</span><span class="p">.</span><span class="nx">push</span> <span class="nx">block</span>

    <span class="mi">1053</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s1">&#39;Alpha Identifiers&#39;</span>

    <span class="mi">1054</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;URL List&#39;</span>

    <span class="mi">1057</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Version Info&#39;</span>

    <span class="mi">1058</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;EXIF data 1&#39;</span>

    <span class="mi">1059</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;EXIF data 3&#39;</span>

    <span class="mi">1060</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;XMP metadata&#39;</span>

    <span class="mi">1061</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Caption digest&#39;</span>

    <span class="mi">1062</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Print scale&#39;</span>

    <span class="mi">1064</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Pixel Aspect Ratio&#39;</span>

    <span class="mi">1065</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Layer Comps&#39;</span>

    <span class="mi">1066</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Alternate Duotone Colors&#39;</span>

    <span class="mi">1067</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Alternate Spot Colors&#39;</span>

    <span class="mi">1069</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Layer Selection ID(s)&#39;</span>

    <span class="mi">1070</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;HDR Toning information&#39;</span>

    <span class="mi">1071</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Print info&quot;</span>

    <span class="mi">1072</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Layer Groups Enabled&quot;</span>

    <span class="mi">1073</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Color samplers resource&quot;</span>

    <span class="mi">1074</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Measurement Scale&quot;</span>

    <span class="mi">1075</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Timeline Information&quot;</span>

    <span class="mi">1076</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Sheet Disclosure&quot;</span>

    <span class="mi">1077</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;DisplayInfo&quot;</span>

    <span class="mi">1078</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Onion Skins&quot;</span>

    <span class="mi">1080</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Count Information&quot;</span>

    <span class="mi">1082</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Print Information&quot;</span>

    <span class="mi">1083</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Print Style&quot;</span>

    <span class="mi">1084</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Recommended to stay away from</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s2">&quot;Macintosh NSPrintInfo&quot;</span>

    <span class="mi">1085</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Recommended to stay away from</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s2">&quot;Windows DEVMODE&quot;</span>

    <span class="mi">2999</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Name of clipping path&#39;</span>

    <span class="mi">7000</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>This is in XML. Yippee.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s2">&quot;Image Ready variables&quot;</span>

    <span class="mi">7001</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s2">&quot;Image Ready data sets&quot;</span>

    <span class="mi">8000</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>If this exists, we're in the middle of a Lightroom
workflow. Strange.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">name: </span><span class="s2">&quot;Lightroom workflow&quot;</span>
      <span class="nv">parse: </span><span class="vi">@isLightroom = </span><span class="kc">true</span>

    <span class="mi">10000</span><span class="o">:</span>
      <span class="nv">name: </span><span class="s1">&#39;Print flags info&#39;</span>
      <span class="nv">parse: </span><span class="o">-&gt;</span>
        <span class="p">[</span>
          <span class="nx">@version</span><span class="p">,</span>
          <span class="nx">@centerCropMarks</span><span class="p">,</span>
          <span class="nx">padding</span><span class="p">,</span>
          <span class="nx">@bleedWidth</span><span class="p">,</span>
          <span class="nx">@bleedWidthScale</span>
        <span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;HBBLH&quot;</span>

  <span class="nv">constructor: </span><span class="nf">(@file) -&gt;</span>

  <span class="nv">parse: </span><span class="o">-&gt;</span>
    <span class="vi">@at = </span><span class="nx">@file</span><span class="p">.</span><span class="nx">tell</span><span class="p">()</span>  

    <span class="p">[</span><span class="nx">@type</span><span class="p">,</span> <span class="nx">@id</span><span class="p">,</span> <span class="nx">@namelen</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;4s H B&quot;</span>

    <span class="nx">Log</span><span class="p">.</span><span class="nx">debug</span> <span class="s2">&quot;Resource ##{@id}: type=#{@type}&quot;</span>

    <span class="nv">n = </span><span class="nx">Util</span><span class="p">.</span><span class="nx">pad2</span><span class="p">(</span><span class="nx">@namelen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="p">[</span><span class="nx">@name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;#{n}s&quot;</span>
    <span class="vi">@name = </span><span class="nx">@name</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">@name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="vi">@shortName = </span><span class="nx">@name</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

    <span class="p">[</span><span class="nx">@size</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@file</span><span class="p">.</span><span class="nx">readf</span> <span class="s2">&quot;&gt;L&quot;</span>
    <span class="vi">@size = </span><span class="nx">Util</span><span class="p">.</span><span class="nx">pad2</span><span class="p">(</span><span class="nx">@size</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">2000</span> <span class="o">&lt;=</span> <span class="nx">@id</span> <span class="o">&lt;=</span> <span class="mi">2997</span>
      <span class="vi">@rdesc = </span><span class="s2">&quot;[Path Information]&quot;</span>
      <span class="nx">@file</span><span class="p">.</span><span class="nx">seek</span> <span class="nx">@size</span>
    <span class="k">else</span> <span class="k">if</span> <span class="mi">4000</span> <span class="o">&lt;=</span> <span class="nx">@id</span> <span class="o">&lt;</span> <span class="mi">5000</span>
      <span class="vi">@rdesc = </span><span class="s2">&quot;[Plug-in Resource]&quot;</span>
      <span class="nx">@file</span><span class="p">.</span><span class="nx">seek</span> <span class="nx">@size</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">RESOURCE_DESCRIPTIONS</span><span class="p">[</span><span class="nx">@id</span><span class="p">]</span><span class="o">?</span>
      <span class="nv">resource = </span><span class="nx">RESOURCE_DESCRIPTIONS</span><span class="p">[</span><span class="nx">@id</span><span class="p">]</span>
      <span class="vi">@rdesc = </span><span class="s2">&quot;[#{resource.name}]&quot;</span>

      <span class="k">if</span> <span class="nx">resource</span><span class="p">.</span><span class="nx">parse</span><span class="o">?</span>
        <span class="nx">resource</span><span class="p">.</span><span class="nx">parse</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="err">@</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="nx">@file</span><span class="p">.</span><span class="nx">seek</span> <span class="nx">@size</span>

    <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="nx">Util</span><span class="p">.</span><span class="nx">pad2</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">@namelen</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="nx">Util</span><span class="p">.</span><span class="nx">pad2</span><span class="p">(</span><span class="nx">@size</span><span class="p">)</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 